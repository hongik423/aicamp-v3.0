# 🧪 AICAMP 환경변수 설정 후 테스트 명령어 가이드

## 📋 현재 환경변수 정보 (2025.01.27 최신)

```bash
# Google Apps Script 정보
GOOGLE_SCRIPT_URL=https://script.google.com/macros/s/AKfycbzYIDWtMiz9mUjuInH981lcKbN4DaXMkYxQ2CHYFMuSW0zd98D6ohdp5NbfdhqLnN0/exec
GOOGLE_SHEETS_ID=1QNgQSsyAdeSu1ejhIm4PFyeSRKy3NmwbLQnKLF8vqA0
GOOGLE_SCRIPT_ID=1mi6DVh9EsVBO7IK5dUUmQpbkqPhuBIcYtLsaE9STfp9_KeZfD9nAw8zj
GOOGLE_DEPLOYMENT_ID=AKfycbzYIDWtMiz9mUjuInH981lcKbN4DaXMkYxQ2CHYFMuSW0zd98D6ohdp5NbfdhqLnN0
ADMIN_EMAIL=hongik423@gmail.com
GOOGLE_GEMINI_API_KEY=AIzaSyAP-Qa4TVNmsc-KAPTuQFjLalDNcvMHoiM
```

## 📍 1. 사이트 접속 테스트

### 🌐 웹 브라우저에서 직접 테스트
```bash
# 1-1) GET 요청 테스트 (상태 확인)
https://script.google.com/macros/s/AKfycbzYIDWtMiz9mUjuInH981lcKbN4DaXMkYxQ2CHYFMuSW0zd98D6ohdp5NbfdhqLnN0/exec

# 1-2) 테스트 파라미터와 함께
https://script.google.com/macros/s/AKfycbzYIDWtMiz9mUjuInH981lcKbN4DaXMkYxQ2CHYFMuSW0zd98D6ohdp5NbfdhqLnN0/exec?test=true
```

### 💻 터미널에서 cURL 테스트
```bash
# 1-3) GET 요청 테스트
curl -X GET "https://script.google.com/macros/s/AKfycbzYIDWtMiz9mUjuInH981lcKbN4DaXMkYxQ2CHYFMuSW0zd98D6ohdp5NbfdhqLnN0/exec"

# 1-4) POST 요청 테스트 (진단 신청)
curl -X POST "https://script.google.com/macros/s/AKfycbzYIDWtMiz9mUjuInH981lcKbN4DaXMkYxQ2CHYFMuSW0zd98D6ohdp5NbfdhqLnN0/exec" \
  -H "Content-Type: application/json" \
  -d '{
    "action": "saveDiagnosis",
    "회사명": "테스트기업",
    "담당자명": "테스트담당자",
    "이메일": "test@example.com",
    "종합점수": 78,
    "문항별점수": {
      "기획수준": 4,
      "차별화정도": 5,
      "가격설정": 3
    }
  }'
```

### 🔧 JavaScript 테스트 (브라우저 콘솔)
```javascript
// 1-5) JavaScript fetch 테스트
fetch('https://script.google.com/macros/s/AKfycbzYIDWtMiz9mUjuInH981lcKbN4DaXMkYxQ2CHYFMuSW0zd98D6ohdp5NbfdhqLnN0/exec', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
  },
  body: JSON.stringify({
    action: 'saveDiagnosis',
    회사명: '테스트기업',
    담당자명: '테스트담당자',
    이메일: 'test@example.com',
    종합점수: 78
  })
})
.then(response => response.json())
.then(data => console.log('✅ 성공:', data))
.catch(error => console.error('❌ 오류:', error));
```

## 📍 2. 전체 시스템 테스트

### 🎯 Google Apps Script 에디터에서 실행
```javascript
// 2-1) 전체 시스템 종합 테스트 (5개 테스트 포함)
testEntireSystem()

// 2-2) 개별 테스트 함수들
testDiagnosisSubmission()        // 진단 신청 테스트
testConsultationSubmission()     // 상담 신청 테스트  
testBetaFeedback()              // 베타 피드백 테스트
checkEnvironmentSync()          // 환경변수 동기화 확인
checkNextjsCompatibility()      // Next.js 호환성 확인
updateExistingSheetHeaders()    // 시트 헤더 업데이트

// 2-3) 직접 실행 시 테스트
doPost()   // POST 요청 시뮬레이션 (직접 실행 감지)
doGet()    // GET 요청 시뮬레이션
```

### 🌐 Node.js 테스트 스크립트
```javascript
// 2-4) test-aicamp-system-comprehensive.js 실행
const testComprehensive = async () => {
  const baseUrl = 'https://script.google.com/macros/s/AKfycbzYIDWtMiz9mUjuIn H981lcKbN4DaXMkYxQ2CHYFMuSW0zd98D6ohdp5NbfdhqLnN0/exec';
  
  // GET 테스트
  console.log('🧪 GET 요청 테스트...');
  const getResponse = await fetch(baseUrl);
  const getResult = await getResponse.json();
  console.log('✅ GET 결과:', getResult);
  
  // POST 테스트 (진단)
  console.log('🧪 진단 POST 요청 테스트...');
  const diagnosisResponse = await fetch(baseUrl, {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
      action: 'saveDiagnosis',
      회사명: '테스트기업',
      담당자명: '테스트담당자',
      이메일: 'test@example.com',
      종합점수: 78
    })
  });
  const diagnosisResult = await diagnosisResponse.json();
  console.log('✅ 진단 결과:', diagnosisResult);
};

testComprehensive();
```

### 📊 구글시트 확인
```bash
# 2-5) 구글시트 직접 확인
https://docs.google.com/spreadsheets/d/1QNgQSsyAdeSu1ejhIm4PFyeSRKy3NmwbLQnKLF8vqA0/edit

# 개별 시트 확인
- AI_무료진단신청: 진단 데이터 (58개 컬럼)
- 상담신청: 상담 데이터 (19개 컬럼)  
- 베타피드백: 피드백 데이터 (14개 컬럼)
```

## 🔍 3. 환경변수 검증 명령어

### ✅ 환경변수 동기화 상태 확인
```bash
# 3-1) Next.js .env.local 파일 확인
cat .env.local

# 3-2) Vercel 환경변수 확인 (Vercel CLI 필요)
vercel env ls

# 3-3) 환경변수 테스트 스크립트 실행
node test-env-sync.js
```

### 📋 예상 테스트 결과
```json
{
  "success": true,
  "timestamp": "2025.01.27 15:30:45",
  "version": "2025.01.27.AICAMP_UTF8완전지원_최종완성_배포버전",
  "status": "AICAMP 통합 시스템 정상 작동 중",
  "deploymentInfo": {
    "scriptId": "1mi6DVh9EsVBO7IK5dUUmQpbkqPhuBIcYtLsaE9STfp9_KeZfD9nAw8zj",
    "deploymentId": "AKfycbzYIDWtMiz9mUjuInH981lcKbN4DaXMkYxQ2CHYFMuSW0zd98D6ohdp5NbfdhqLnN0",
    "webAppUrl": "https://script.google.com/macros/s/AKfycbzYIDWtMiz9mUjuInH981lcKbN4DaXMkYxQ2CHYFMuSW0zd98D6ohdp5NbfdhqLnN0/exec",
    "lastUpdated": "2025.01.27"
  },
  "features": [
    "✅ 진단신청 처리 (58개 컬럼)",
    "✅ 상담신청 처리 (19개 컬럼)", 
    "✅ 베타피드백 처리 (14개 컬럼)",
    "✅ 진단점수 정확 저장 (1-5점)",
    "✅ 자동 이메일 발송",
    "✅ 관리자/신청자 알림",
    "✅ 환경변수 완전 동기화",
    "✅ 실시간 백업 시스템"
  ]
}
```

## 🚨 4. 오류 해결 가이드

### ❌ 자주 발생하는 오류와 해결책

1. **"스크립트 실행 권한 없음" 오류**
   ```bash
   # 해결: Google Apps Script에서 권한 재설정
   1. Apps Script 에디터 → 배포 → 웹 앱으로 배포
   2. "액세스 권한: 모든 사용자" 설정
   3. "새 배포" 생성
   ```

2. **"CORS 오류" 발생**
   ```bash
   # 해결: 서버사이드에서 요청하거나 프록시 사용
   # Next.js API Route 사용 권장
   ```

3. **"환경변수 불일치" 오류**
   ```bash
   # 해결: 환경변수 재동기화
   checkEnvironmentSync()  # Apps Script에서 실행
   ```

4. **"시트 접근 권한 없음" 오류**
   ```bash
   # 해결: Google Sheets 공유 설정 확인
   # hongik423@gmail.com 계정으로 스크립트 실행 필요
   ```

## 📞 5. 추가 도움

### 🔧 문제 발생 시 연락처
- **관리자 이메일**: hongik423@gmail.com
- **전화**: 010-9251-9743 (이후경 교장)

### 📚 관련 문서
- `AICAMP_GAS_완전무오류_검증보고서.md`
- `VERCEL_배포_완료_최종보고서.md`
- `환경변수_설정_가이드.md`

---
**마지막 업데이트**: 2025.01.27
**버전**: AICAMP UTF-8 완전지원 최종완성 배포버전 