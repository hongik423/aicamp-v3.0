<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI ì—­ëŸ‰ì§„ë‹¨ ì›Œí¬í”Œë¡œìš° í…ŒìŠ¤íŠ¸</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .step-active { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; }
        .step-complete { background: #10b981; color: white; }
        .step-pending { background: #e5e7eb; color: #6b7280; }
        .test-pass { background: #10b981; color: white; }
        .test-fail { background: #ef4444; color: white; }
        .test-running { background: #3b82f6; color: white; animation: pulse 2s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.7; } }
    </style>
</head>
<body class="bg-gradient-to-br from-purple-50 via-white to-blue-50 min-h-screen p-8">
    <div class="max-w-6xl mx-auto">
        <!-- í—¤ë” -->
        <div class="bg-white rounded-2xl shadow-lg p-6 mb-8">
            <h1 class="text-3xl font-bold text-gray-900 mb-2">ğŸš€ AI ì—­ëŸ‰ì§„ë‹¨ ì‹œìŠ¤í…œ ì›Œí¬í”Œë¡œìš° í…ŒìŠ¤íŠ¸</h1>
            <p class="text-gray-600">AICAMP v3.0 - ì „ì²´ í”„ë¡œì„¸ìŠ¤ ìë™ ê²€ì¦</p>
        </div>

        <!-- ì›Œí¬í”Œë¡œìš° ë‹¨ê³„ í‘œì‹œ -->
        <div class="bg-white rounded-2xl shadow-lg p-6 mb-8">
            <h2 class="text-xl font-bold mb-4">ğŸ“‹ ì›Œí¬í”Œë¡œìš° ì§„í–‰ ìƒíƒœ</h2>
            <div class="grid grid-cols-5 gap-4">
                <div id="step1" class="step-pending p-4 rounded-xl text-center">
                    <div class="text-2xl mb-2">ğŸ“</div>
                    <div class="font-semibold">1. ì‹ ì²­ì„œ ì‘ì„±</div>
                </div>
                <div id="step2" class="step-pending p-4 rounded-xl text-center">
                    <div class="text-2xl mb-2">ğŸ“§</div>
                    <div class="font-semibold">2. ì´ë©”ì¼ ë°œì†¡</div>
                </div>
                <div id="step3" class="step-pending p-4 rounded-xl text-center">
                    <div class="text-2xl mb-2">ğŸ¤–</div>
                    <div class="font-semibold">3. AI ë¶„ì„</div>
                </div>
                <div id="step4" class="step-pending p-4 rounded-xl text-center">
                    <div class="text-2xl mb-2">ğŸ“Š</div>
                    <div class="font-semibold">4. ë³´ê³ ì„œ ìƒì„±</div>
                </div>
                <div id="step5" class="step-pending p-4 rounded-xl text-center">
                    <div class="text-2xl mb-2">ğŸ’¾</div>
                    <div class="font-semibold">5. ë°ì´í„° ì €ì¥</div>
                </div>
            </div>
        </div>

        <!-- í…ŒìŠ¤íŠ¸ ì»¨íŠ¸ë¡¤ -->
        <div class="bg-white rounded-2xl shadow-lg p-6 mb-8">
            <h2 class="text-xl font-bold mb-4">ğŸ® í…ŒìŠ¤íŠ¸ ì»¨íŠ¸ë¡¤</h2>
            <div class="grid grid-cols-3 gap-4 mb-6">
                <button onclick="runFullTest()" class="bg-gradient-to-r from-purple-600 to-blue-600 text-white py-3 px-6 rounded-xl hover:shadow-lg transition-all">
                    ğŸš€ ì „ì²´ ì›Œí¬í”Œë¡œìš° í…ŒìŠ¤íŠ¸
                </button>
                <button onclick="testAIDiagnosis()" class="bg-blue-600 text-white py-3 px-6 rounded-xl hover:shadow-lg transition-all">
                    ğŸ¤– AI ì—­ëŸ‰ì§„ë‹¨ í…ŒìŠ¤íŠ¸
                </button>
                <button onclick="testConsultation()" class="bg-green-600 text-white py-3 px-6 rounded-xl hover:shadow-lg transition-all">
                    ğŸ“ ìƒë‹´ì‹ ì²­ í…ŒìŠ¤íŠ¸
                </button>
            </div>
            <div class="grid grid-cols-3 gap-4">
                <button onclick="testErrorReport()" class="bg-orange-600 text-white py-3 px-6 rounded-xl hover:shadow-lg transition-all">
                    ğŸ› ì˜¤ë¥˜ì‹ ê³  í…ŒìŠ¤íŠ¸
                </button>
                <button onclick="checkGoogleSheet()" class="bg-purple-600 text-white py-3 px-6 rounded-xl hover:shadow-lg transition-all">
                    ğŸ“‹ êµ¬ê¸€ì‹œíŠ¸ í™•ì¸
                </button>
                <button onclick="clearTests()" class="bg-gray-600 text-white py-3 px-6 rounded-xl hover:shadow-lg transition-all">
                    ğŸ—‘ï¸ í…ŒìŠ¤íŠ¸ ì´ˆê¸°í™”
                </button>
            </div>
        </div>

        <!-- í…ŒìŠ¤íŠ¸ ê²°ê³¼ -->
        <div class="bg-white rounded-2xl shadow-lg p-6 mb-8">
            <h2 class="text-xl font-bold mb-4">ğŸ“Š í…ŒìŠ¤íŠ¸ ê²°ê³¼</h2>
            <div id="testResults" class="space-y-3">
                <div class="text-gray-500 text-center py-8">í…ŒìŠ¤íŠ¸ë¥¼ ì‹œì‘í•˜ë ¤ë©´ ìœ„ì˜ ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”</div>
            </div>
        </div>

        <!-- ìƒì„¸ ë¡œê·¸ -->
        <div class="bg-white rounded-2xl shadow-lg p-6">
            <h2 class="text-xl font-bold mb-4">ğŸ“ ìƒì„¸ ë¡œê·¸</h2>
            <div id="detailLog" class="bg-gray-50 rounded-xl p-4 h-64 overflow-y-auto font-mono text-sm">
                <div class="text-gray-500">í…ŒìŠ¤íŠ¸ ë¡œê·¸ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤...</div>
            </div>
        </div>
    </div>

    <script>
        // í…ŒìŠ¤íŠ¸ ë°ì´í„°
        const testData = {
            aiDiagnosis: {
                companyName: 'AICAMP í…ŒìŠ¤íŠ¸ê¸°ì—…',
                applicantName: 'í™ê¸¸ë™',
                position: 'CEO',
                email: 'test@aicamp.co.kr',
                phone: '010-1234-5678',
                industry: 'IT/ì†Œí”„íŠ¸ì›¨ì–´',
                employeeCount: '51-100ëª…',
                businessContent: 'AI êµìœ¡ ë° ì»¨ì„¤íŒ… ì„œë¹„ìŠ¤',
                currentChallenges: 'AI ë„ì… ì „ëµ ìˆ˜ë¦½ í•„ìš”',
                expectedEffects: 'ì—…ë¬´ íš¨ìœ¨ì„± 30% í–¥ìƒ',
                assessmentResponses: {
                    'ai_understanding': 3,
                    'ai_strategy': 2,
                    'data_management': 3,
                    'ai_infrastructure': 2,
                    'ai_talent': 1,
                    'ai_culture': 3,
                    'ai_investment': 2,
                    'ai_ethics': 3
                },
                privacyConsent: true
            },
            consultation: {
                consultationType: 'AIë„ì…ì»¨ì„¤íŒ…',
                name: 'ê¹€ì² ìˆ˜',
                phone: '010-9876-5432',
                email: 'kim@test.com',
                company: 'í…ŒìŠ¤íŠ¸ì»´í¼ë‹ˆ',
                consultationArea: 'AI ìë™í™”',
                inquiryContent: 'RPA ë„ì… ìƒë‹´ ìš”ì²­',
                privacyConsent: true
            },
            errorReport: {
                name: 'ì´ì˜í¬',
                email: 'lee@test.com',
                phone: '010-5555-5555',
                calculatorType: 'ë²•ì¸ì„¸ ê³„ì‚°ê¸°',
                errorDescription: 'ê³„ì‚° ê²°ê³¼ê°€ ì˜ëª» í‘œì‹œë¨',
                expectedBehavior: 'ì •í™•í•œ ì„¸ê¸ˆ ê³„ì‚°',
                actualBehavior: '0ì›ìœ¼ë¡œ í‘œì‹œ',
                stepsToReproduce: '1. ë§¤ì¶œì•¡ ì…ë ¥\n2. ê³„ì‚° ë²„íŠ¼ í´ë¦­',
                browserInfo: navigator.userAgent
            }
        };

        let logCount = 0;

        function addLog(message, type = 'info') {
            const logDiv = document.getElementById('detailLog');
            const timestamp = new Date().toLocaleTimeString('ko-KR');
            const typeIcon = {
                'info': 'â„¹ï¸',
                'success': 'âœ…',
                'error': 'âŒ',
                'warning': 'âš ï¸',
                'running': 'ğŸ”„'
            }[type] || 'â„¹ï¸';
            
            const logEntry = document.createElement('div');
            logEntry.className = `py-1 ${type === 'error' ? 'text-red-600' : type === 'success' ? 'text-green-600' : 'text-gray-700'}`;
            logEntry.innerHTML = `[${timestamp}] ${typeIcon} ${message}`;
            
            if (logCount === 0) {
                logDiv.innerHTML = '';
            }
            logDiv.appendChild(logEntry);
            logDiv.scrollTop = logDiv.scrollHeight;
            logCount++;
        }

        function addTestResult(testName, status, message = '') {
            const resultsDiv = document.getElementById('testResults');
            if (resultsDiv.querySelector('.text-gray-500')) {
                resultsDiv.innerHTML = '';
            }
            
            const resultDiv = document.createElement('div');
            const statusClass = status === 'pass' ? 'test-pass' : status === 'fail' ? 'test-fail' : 'test-running';
            const statusIcon = status === 'pass' ? 'âœ…' : status === 'fail' ? 'âŒ' : 'ğŸ”„';
            
            resultDiv.className = `${statusClass} p-3 rounded-xl flex justify-between items-center`;
            resultDiv.innerHTML = `
                <div class="flex items-center gap-3">
                    <span class="text-2xl">${statusIcon}</span>
                    <span class="font-semibold">${testName}</span>
                </div>
                <span class="text-sm">${message}</span>
            `;
            
            resultsDiv.appendChild(resultDiv);
        }

        function updateStep(stepNumber, status) {
            const stepDiv = document.getElementById(`step${stepNumber}`);
            stepDiv.className = `step-${status} p-4 rounded-xl text-center transition-all`;
        }

        async function runFullTest() {
            addLog('ğŸš€ ì „ì²´ ì›Œí¬í”Œë¡œìš° í…ŒìŠ¤íŠ¸ ì‹œì‘', 'info');
            
            // ì´ˆê¸°í™”
            for (let i = 1; i <= 5; i++) {
                updateStep(i, 'pending');
            }
            
            // 1. AI ì—­ëŸ‰ì§„ë‹¨ í…ŒìŠ¤íŠ¸
            addLog('AI ì—­ëŸ‰ì§„ë‹¨ í”„ë¡œì„¸ìŠ¤ ì‹œì‘', 'running');
            updateStep(1, 'active');
            const diagnosisResult = await testAIDiagnosis();
            
            if (diagnosisResult.success) {
                updateStep(1, 'complete');
                updateStep(2, 'complete');
                updateStep(3, 'complete');
                updateStep(4, 'complete');
                updateStep(5, 'complete');
                addTestResult('ì „ì²´ ì›Œí¬í”Œë¡œìš°', 'pass', 'ëª¨ë“  ë‹¨ê³„ ì„±ê³µ');
            } else {
                addTestResult('ì „ì²´ ì›Œí¬í”Œë¡œìš°', 'fail', 'ì¼ë¶€ ë‹¨ê³„ ì‹¤íŒ¨');
            }
            
            addLog('âœ… ì „ì²´ ì›Œí¬í”Œë¡œìš° í…ŒìŠ¤íŠ¸ ì™„ë£Œ', 'success');
        }

        async function testAIDiagnosis() {
            addLog('AI ì—­ëŸ‰ì§„ë‹¨ í…ŒìŠ¤íŠ¸ ì‹œì‘', 'running');
            addTestResult('AI ì—­ëŸ‰ì§„ë‹¨', 'running', 'ì²˜ë¦¬ ì¤‘...');
            
            try {
                updateStep(1, 'active');
                
                // API í˜¸ì¶œ
                const response = await fetch('/api/ai-capability-diagnosis', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(testData.aiDiagnosis)
                });
                
                const result = await response.json();
                
                if (result.success) {
                    addLog(`âœ… AI ì—­ëŸ‰ì§„ë‹¨ ì„±ê³µ: ì§„ë‹¨ID ${result.diagnosisId}`, 'success');
                    
                    // ê²°ê³¼ í˜ì´ì§€ í™•ì¸
                    if (result.diagnosisId) {
                        addLog(`ğŸ“Š ê²°ê³¼ í˜ì´ì§€: /diagnosis/result/${result.diagnosisId}`, 'info');
                        window.open(`/diagnosis/result/${result.diagnosisId}`, '_blank');
                    }
                    
                    addTestResult('AI ì—­ëŸ‰ì§„ë‹¨', 'pass', `ì§„ë‹¨ID: ${result.diagnosisId}`);
                    return { success: true, diagnosisId: result.diagnosisId };
                } else {
                    throw new Error(result.error || 'ì§„ë‹¨ ì‹¤íŒ¨');
                }
            } catch (error) {
                addLog(`âŒ AI ì—­ëŸ‰ì§„ë‹¨ ì‹¤íŒ¨: ${error.message}`, 'error');
                addTestResult('AI ì—­ëŸ‰ì§„ë‹¨', 'fail', error.message);
                return { success: false, error: error.message };
            }
        }

        async function testConsultation() {
            addLog('ìƒë‹´ì‹ ì²­ í…ŒìŠ¤íŠ¸ ì‹œì‘', 'running');
            addTestResult('ìƒë‹´ì‹ ì²­', 'running', 'ì²˜ë¦¬ ì¤‘...');
            
            try {
                const response = await fetch('/api/consultation', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(testData.consultation)
                });
                
                const result = await response.json();
                
                if (result.success) {
                    addLog('âœ… ìƒë‹´ì‹ ì²­ ì„±ê³µ', 'success');
                    addTestResult('ìƒë‹´ì‹ ì²­', 'pass', 'ì´ë©”ì¼ ë°œì†¡ ì™„ë£Œ');
                } else {
                    throw new Error(result.error || 'ìƒë‹´ì‹ ì²­ ì‹¤íŒ¨');
                }
            } catch (error) {
                addLog(`âŒ ìƒë‹´ì‹ ì²­ ì‹¤íŒ¨: ${error.message}`, 'error');
                addTestResult('ìƒë‹´ì‹ ì²­', 'fail', error.message);
            }
        }

        async function testErrorReport() {
            addLog('ì˜¤ë¥˜ì‹ ê³  í…ŒìŠ¤íŠ¸ ì‹œì‘', 'running');
            addTestResult('ì˜¤ë¥˜ì‹ ê³ ', 'running', 'ì²˜ë¦¬ ì¤‘...');
            
            try {
                const response = await fetch('/api/tax-calculator/error-report', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        ...testData.errorReport,
                        timestamp: new Date().toISOString()
                    })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    addLog('âœ… ì˜¤ë¥˜ì‹ ê³  ì„±ê³µ', 'success');
                    addTestResult('ì˜¤ë¥˜ì‹ ê³ ', 'pass', 'ì‹ ê³  ì ‘ìˆ˜ ì™„ë£Œ');
                } else {
                    throw new Error(result.error || 'ì˜¤ë¥˜ì‹ ê³  ì‹¤íŒ¨');
                }
            } catch (error) {
                addLog(`âŒ ì˜¤ë¥˜ì‹ ê³  ì‹¤íŒ¨: ${error.message}`, 'error');
                addTestResult('ì˜¤ë¥˜ì‹ ê³ ', 'fail', error.message);
            }
        }

        async function checkGoogleSheet() {
            addLog('êµ¬ê¸€ì‹œíŠ¸ ë°ì´í„° í™•ì¸ ì¤‘...', 'info');
            const sheetUrl = 'https://docs.google.com/spreadsheets/d/1QNgQSsyAdeSu1ejhIm4PFyeSRKy3NmwbLQnKLF8vqA0/edit';
            addLog(`ğŸ“‹ êµ¬ê¸€ì‹œíŠ¸ URL: ${sheetUrl}`, 'info');
            window.open(sheetUrl, '_blank');
            addTestResult('êµ¬ê¸€ì‹œíŠ¸ í™•ì¸', 'pass', 'ìƒˆ ì°½ì—ì„œ ì—´ë¦¼');
        }

        function clearTests() {
            document.getElementById('testResults').innerHTML = '<div class="text-gray-500 text-center py-8">í…ŒìŠ¤íŠ¸ë¥¼ ì‹œì‘í•˜ë ¤ë©´ ìœ„ì˜ ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”</div>';
            document.getElementById('detailLog').innerHTML = '<div class="text-gray-500">í…ŒìŠ¤íŠ¸ ë¡œê·¸ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤...</div>';
            for (let i = 1; i <= 5; i++) {
                updateStep(i, 'pending');
            }
            logCount = 0;
            addLog('ğŸ—‘ï¸ í…ŒìŠ¤íŠ¸ ì´ˆê¸°í™” ì™„ë£Œ', 'info');
        }

        // í˜ì´ì§€ ë¡œë“œì‹œ ì´ˆê¸° ë¡œê·¸
        window.addEventListener('load', () => {
            addLog('âœ¨ AI ì—­ëŸ‰ì§„ë‹¨ ì›Œí¬í”Œë¡œìš° í…ŒìŠ¤íŠ¸ ì‹œìŠ¤í…œ ì¤€ë¹„ ì™„ë£Œ', 'success');
            addLog('ğŸ“Œ GEMINI API Key: AIzaSyAP-Qa4TVNmsc-KAPTuQFjLalDNcvMHoiM', 'info');
            addLog('ğŸ“Œ ê´€ë¦¬ì ì´ë©”ì¼: hongik423@gmail.com', 'info');
        });
    </script>
</body>
</html>