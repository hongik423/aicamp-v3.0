/**
 * ğŸš€ Google Apps Script ì´ë©”ì¼ ë°œì†¡ ì „ìš© í…ŒìŠ¤íŠ¸
 * ê´€ë¦¬ìì™€ ì‹ ì²­ì í™•ì¸ ì´ë©”ì¼ ì •ìƒ ë°œì†¡ í…ŒìŠ¤íŠ¸
 */

const axios = require('axios');

const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbzYIDWtMiz9mUjuInH981lcKbN4DaXMkYxQ2CHYFMuSW0zd98D6ohdp5NbfdhqLnN0/exec';

/**
 * ğŸ¯ ê³ ê¸‰ ì§„ë‹¨ ë°ì´í„° ìƒì„± (ì™„ì „í•œ ë°ì´í„°)
 */
function createCompleteTestData() {
  return {
    action: 'saveDiagnosis',
    í¼íƒ€ì…: 'AI_ê³ ê¸‰ì§„ë‹¨_ì—…ì¢…íŠ¹í™”ë¶„ì„',
    ì œì¶œì¼ì‹œ: new Date().toLocaleString('ko-KR', { timeZone: 'Asia/Seoul' }),
    timestamp: Date.now(),
    
    // ê¸°ë³¸ ì •ë³´
    íšŒì‚¬ëª…: 'í…ŒìŠ¤íŠ¸ê¸°ì—…_ê³ ê¸‰ì§„ë‹¨_ì´ë©”ì¼',
    ì—…ì¢…: 'manufacturing',
    ì‚¬ì—…ë‹´ë‹¹ì: 'ê¹€ì‚¬ì—…ë‹´ë‹¹',
    ì§ì›ìˆ˜: '10-50ëª…',
    ì‚¬ì—…ì„±ì¥ë‹¨ê³„: 'ì„±ì¥ê¸°',
    ì£¼ìš”ê³ ë¯¼ì‚¬í•­: 'ì œì¡°ì—… ë””ì§€í„¸ ì „í™˜ê³¼ ìƒì‚°ì„± í–¥ìƒì´ í•„ìš”í•©ë‹ˆë‹¤.',
    ì˜ˆìƒí˜œíƒ: 'ìŠ¤ë§ˆíŠ¸íŒ©í† ë¦¬ ë„ì…ì„ í†µí•œ ìƒì‚° íš¨ìœ¨ì„± 30% í–¥ìƒì„ ê¸°ëŒ€í•©ë‹ˆë‹¤.',
    ì§„í–‰ì‚¬ì—…ì¥: 'ì„œìš¸',
    ë‹´ë‹¹ìëª…: 'ê¹€í…ŒìŠ¤íŠ¸_ì´ë©”ì¼ë°œì†¡',
    ì—°ë½ì²˜: '010-1234-5678',
    ì´ë©”ì¼: 'aicamp.test.email@gmail.com',
    ê°œì¸ì •ë³´ë™ì˜: true,
    
    // ì§„ë‹¨ ê²°ê³¼
    ì¢…í•©ì ìˆ˜: 74,
    ì§„ë‹¨ë“±ê¸‰: 'B+',
    ì‹ ë¢°ë„ì ìˆ˜: 92,
    
    // ğŸ“Š ê°œë³„ ì ìˆ˜ 20ê°œ ë¬¸í•­
    ë¬¸í•­ë³„ì ìˆ˜: {
      ê¸°íšìˆ˜ì¤€: 4,
      ì°¨ë³„í™”ì •ë„: 3,
      ê°€ê²©ì„¤ì •: 4,
      ì „ë¬¸ì„±: 5,
      í’ˆì§ˆ: 4,
      ê³ ê°ë§ì´: 3,
      ê³ ê°ì‘ëŒ€: 4,
      ë¶ˆë§Œê´€ë¦¬: 3,
      ê³ ê°ìœ ì§€: 4,
      ê³ ê°ì´í•´: 3,
      ë§ˆì¼€íŒ…ê³„íš: 2,
      ì˜¤í”„ë¼ì¸ë§ˆì¼€íŒ…: 3,
      ì˜¨ë¼ì¸ë§ˆì¼€íŒ…: 2,
      íŒë§¤ì „ëµ: 3,
      êµ¬ë§¤ê´€ë¦¬: 4,
      ì¬ê³ ê´€ë¦¬: 4,
      ì™¸ê´€ê´€ë¦¬: 5,
      ì¸í…Œë¦¬ì–´ê´€ë¦¬: 4,
      ì²­ê²°ë„: 5,
      ì‘ì—…ë™ì„ : 4
    },
    
    // ğŸ“ˆ ì¹´í…Œê³ ë¦¬ë³„ ì ìˆ˜
    ì¹´í…Œê³ ë¦¬ì ìˆ˜: {
      productService: { score: 80 },
      customerService: { score: 70 },
      marketing: { score: 52 },
      procurement: { score: 80 },
      storeManagement: { score: 90 }
    },
    
    // ğŸš€ 6ê°€ì§€ í•µì‹¬ ì§€í‘œ
    businessModel: 75,
    marketPosition: 68,
    operationalEfficiency: 82,
    growthPotential: 77,
    digitalReadiness: 60,
    financialHealth: 73,
    
    // ğŸ¯ ì—…ì¢…ë³„ íŠ¹í™” ë¶„ì„
    ì—…ì¢…ë¶„ì„: {
      ì—…ì¢…íŠ¹í™”ë¶„ì„: 'ì œì¡°ì—… íŠ¹í™” ë¶„ì„: ìƒì‚° íš¨ìœ¨ì„± 74ì , í’ˆì§ˆê´€ë¦¬ ì‹œìŠ¤í…œ ìš°ìˆ˜, ìŠ¤ë§ˆíŠ¸íŒ©í† ë¦¬ ë„ì… ê²€í†  ê¶Œì¥',
      ì‹œì¥ìœ„ì¹˜: 'ì œì¡°ì—… ì—…ê³„ í‰ê·  ìˆ˜ì¤€',
      ê²½ìŸë ¥ë¶„ì„: 'í…ŒìŠ¤íŠ¸ê¸°ì—…ì˜ ì œì¡°ì—… ì—…ê³„ ê²½ìŸë ¥: ë³´í†µ (74ì ), ì°¨ë³„í™” ì „ëµ ë° í•µì‹¬ ì—­ëŸ‰ ê°•í™” í•„ìš”',
      ì„±ì¥ì ì¬ë ¥: 'ì„±ì¥ê¸° ë‹¨ê³„ ì„±ì¥ ì ì¬ë ¥: 84ì , ë†’ìŒ'
    },
    
    // ğŸ“‹ SWOT ë¶„ì„
    SWOTë¶„ì„: {
      ê°•ì : ['ì œì¡°ì—… ì—…ì¢… ì „ë¬¸ì„±', 'ìš°ìˆ˜í•œ í’ˆì§ˆ ê´€ë¦¬', 'ê³ ê° ì¶©ì„±ë„', 'íš¨ìœ¨ì  ìš´ì˜', 'ë¸Œëœë“œ ì‹ ë¢°ë„'],
      ì•½ì : ['ë””ì§€í„¸ ë§ˆì¼€íŒ… ì—­ëŸ‰ ë¶€ì¡±', 'ì˜¨ë¼ì¸ ì±„ë„ ë¯¸í¡', 'ì¸ë ¥ ë¶€ì¡±', 'ì‹œìŠ¤í…œ ë…¸í›„í™”', 'ë°ì´í„° ë¶„ì„ ë¶€ì¡±'],
      ê¸°íšŒ: ['ì œì¡°ì—… ì‹œì¥ ì„±ì¥', 'ë””ì§€í„¸ ì „í™˜ ê°€ì†í™”', 'ì •ë¶€ ì§€ì› ì •ì±…', 'ì‹ ê¸°ìˆ  ë„ì… ê¸°íšŒ', 'í•´ì™¸ ì§„ì¶œ ê°€ëŠ¥ì„±'],
      ìœ„í˜‘: ['ëŒ€ê¸°ì—… ì§„ì¶œ', 'ê²½ìŸ ì‹¬í™”', 'ê²½ê¸° ë¶ˆí™•ì‹¤ì„±', 'ê·œì œ ê°•í™”', 'ë¹„ìš© ìƒìŠ¹'],
      ì „ëµë§¤íŠ¸ë¦­ìŠ¤: 'ì œì¡°ì—… ì—…ì¢… íŠ¹í™” ì „ëµ: ê°•ì ì„ í™œìš©í•œ ë””ì§€í„¸ ì „í™˜ê³¼ ì‹œì¥ í™•ì¥ì„ í†µí•´ ì„±ì¥ ê¸°íšŒë¥¼ ê·¹ëŒ€í™”í•˜ê³  ìœ„í˜‘ ìš”ì†Œë¥¼ ìµœì†Œí™”í•´ì•¼ í•©ë‹ˆë‹¤.'
    },
    
    // ğŸš€ ë§ì¶¤ ì„œë¹„ìŠ¤ ì¶”ì²œ
    ì¶”ì²œì„œë¹„ìŠ¤: 'AI ë„êµ¬ í™œìš© ì—…ë¬´ íš¨ìœ¨í™”, ìŠ¤ë§ˆíŠ¸ íŒ©í† ë¦¬ ë„ì… ì»¨ì„¤íŒ…, ì œì¡°ì—… ë””ì§€í„¸ ì „í™˜',
    
    // ğŸ“„ ì§„ë‹¨ë³´ê³ ì„œ ìš”ì•½ (4000ì)
    ì§„ë‹¨ë³´ê³ ì„œìš”ì•½: generateManufacturingReport(),
    
    // ì´ë©”ì¼ ë°œì†¡ í”Œë˜ê·¸
    sendConfirmationEmail: true,
    sendAdminNotification: true
  };
}

/**
 * ì œì¡°ì—… íŠ¹í™” ë³´ê³ ì„œ ìƒì„±
 */
function generateManufacturingReport() {
  return `
1. ì œì¡°ì—… í˜„í™© ì§„ë‹¨

ê·€í•˜ì˜ ì œì¡°ì—…ì²´ëŠ” í˜„ì¬ 74ì ì˜ ì¢…í•© ì§„ë‹¨ ì ìˆ˜ë¥¼ ê¸°ë¡í•˜ì—¬ ì—…ê³„ í‰ê·  ìˆ˜ì¤€ì˜ ê²½ìŸë ¥ì„ ë³´ìœ í•˜ê³  ìˆìŠµë‹ˆë‹¤. íŠ¹íˆ í’ˆì§ˆ ê´€ë¦¬ì™€ ì‘ì—… ë™ì„  íš¨ìœ¨ì„±ì—ì„œ 5ì  ë§Œì ì„ íšë“í•˜ì—¬ ì œì¡°ì—…ì˜ í•µì‹¬ ì—­ëŸ‰ì„ ì˜ ê°–ì¶”ê³  ìˆìŒì„ ë³´ì—¬ì¤ë‹ˆë‹¤.

ìƒì‚° íš¨ìœ¨ì„± ì¸¡ë©´ì—ì„œëŠ” ìš´ì˜íš¨ìœ¨ì„± ì§€í‘œê°€ 82ì ìœ¼ë¡œ ìš°ìˆ˜í•œ ìˆ˜ì¤€ì„ ë‚˜íƒ€ë‚´ê³  ìˆìœ¼ë‚˜, ë””ì§€í„¸ ì¤€ë¹„ë„ê°€ 60ì ìœ¼ë¡œ ìƒëŒ€ì ìœ¼ë¡œ ë‚®ì•„ ìŠ¤ë§ˆíŠ¸ íŒ©í† ë¦¬ ë„ì…ê³¼ ë””ì§€í„¸ ì „í™˜ì´ ì‹œê¸‰í•œ ê³¼ì œë¡œ ë‚˜íƒ€ë‚¬ìŠµë‹ˆë‹¤.

2. ê°•ì  ê¸°ë°˜ ì„±ì¥ ì „ëµ

ì œì¡°ì—… íŠ¹í™” ê°•ì ì¸ í’ˆì§ˆê´€ë¦¬ ì‹œìŠ¤í…œê³¼ ìƒì‚° ì „ë¬¸ì„±ì„ ê¸°ë°˜ìœ¼ë¡œ ì‹œì¥ í™•ì¥ ì „ëµì„ ìˆ˜ë¦½í•´ì•¼ í•©ë‹ˆë‹¤. í˜„ì¬ 82ì ì˜ ìš´ì˜ íš¨ìœ¨ì„±ì€ ì—…ê³„ ìƒìœ„ 20% ìˆ˜ì¤€ìœ¼ë¡œ, ì´ë¥¼ ë°”íƒ•ìœ¼ë¡œ ìƒì‚°ì„± í–¥ìƒê³¼ ì›ê°€ ì ˆê°ì„ í†µí•œ ê°€ê²© ê²½ìŸë ¥ í™•ë³´ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤.

3. ë””ì§€í„¸ ì „í™˜ ìš°ì„ ìˆœìœ„

ìŠ¤ë§ˆíŠ¸ íŒ©í† ë¦¬ ë„ì…ì„ ìœ„í•œ ë‹¨ê³„ë³„ ì ‘ê·¼ì´ í•„ìš”í•©ë‹ˆë‹¤. IoT ì„¼ì„œë¥¼ í†µí•œ ì„¤ë¹„ ëª¨ë‹ˆí„°ë§ë¶€í„° ì‹œì‘í•˜ì—¬ ë°ì´í„° ìˆ˜ì§‘ ë° ë¶„ì„ ì²´ê³„ë¥¼ êµ¬ì¶•í•˜ê³ , ê¶ê·¹ì ìœ¼ë¡œ AI ê¸°ë°˜ ì˜ˆì¸¡ ìœ ì§€ë³´ìˆ˜ ì‹œìŠ¤í…œ ë„ì…ì„ ê¶Œì¥í•©ë‹ˆë‹¤.

4. ë§ˆì¼€íŒ… ì—­ëŸ‰ ê°•í™” ë°©ì•ˆ

í˜„ì¬ ë§ˆì¼€íŒ… ì ìˆ˜ê°€ 52ì ìœ¼ë¡œ ê°œì„ ì´ í•„ìš”í•œ ì˜ì—­ì…ë‹ˆë‹¤. íŠ¹íˆ ì˜¨ë¼ì¸ ë§ˆì¼€íŒ… ì—­ëŸ‰ ê°•í™”ë¥¼ í†µí•´ B2B ê³ ê° í™•ë³´ì™€ í•´ì™¸ ì‹œì¥ ì§„ì¶œ ê¸°íšŒë¥¼ ëª¨ìƒ‰í•´ì•¼ í•©ë‹ˆë‹¤. ì œì¡°ì—… ì „ë¬¸ í”Œë«í¼ í™œìš©ê³¼ ë””ì§€í„¸ ì¹´íƒˆë¡œê·¸ êµ¬ì¶•ì„ í†µí•œ ë§ˆì¼€íŒ… íš¨ìœ¨ì„± ì œê³ ê°€ í•„ìš”í•©ë‹ˆë‹¤.

5. 6ê°€ì§€ í•µì‹¬ ì§€í‘œ ë¶„ì„

ë¹„ì¦ˆë‹ˆìŠ¤ëª¨ë¸(75ì ): ì•ˆì •ì ì¸ ì‚¬ì—… êµ¬ì¡°ë¥¼ ë°”íƒ•ìœ¼ë¡œ í•œ ì„±ì¥ ê°€ëŠ¥ì„±ì´ í™•ì¸ë©ë‹ˆë‹¤.
ì‹œì¥ìœ„ì¹˜(68ì ): ì—…ê³„ í‰ê·  ìˆ˜ì¤€ì˜ ì‹œì¥ ì ìœ ìœ¨ì„ ë³´ìœ í•˜ê³  ìˆìœ¼ë‚˜, ë¸Œëœë“œ ì°¨ë³„í™”ê°€ í•„ìš”í•©ë‹ˆë‹¤.
ìš´ì˜íš¨ìœ¨ì„±(82ì ): ìš°ìˆ˜í•œ ìˆ˜ì¤€ì˜ ìš´ì˜ ì²´ê³„ë¥¼ êµ¬ì¶•í•˜ê³  ìˆì–´ ê²½ìŸ ìš°ìœ„ ìš”ì†Œë¡œ í™œìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.
ì„±ì¥ì ì¬ë ¥(77ì ): ë†’ì€ ì„±ì¥ ê°€ëŠ¥ì„±ì„ ë³´ì—¬ì£¼ë©°, ì ê·¹ì ì¸ íˆ¬ìì™€ í™•ì¥ ì „ëµ ìˆ˜ë¦½ì´ ê¶Œì¥ë©ë‹ˆë‹¤.
ë””ì§€í„¸ì¤€ë¹„ë„(60ì ): ë””ì§€í„¸ ì „í™˜ì´ ì‹œê¸‰í•œ ê³¼ì œë¡œ, ë‹¨ê³„ì  ì ‘ê·¼ì„ í†µí•œ ê°œì„ ì´ í•„ìš”í•©ë‹ˆë‹¤.
ì¬ë¬´ê±´ì „ì„±(73ì ): ì•ˆì •ì ì¸ ì¬ë¬´ êµ¬ì¡°ë¥¼ ë°”íƒ•ìœ¼ë¡œ í•œ ì§€ì† ì„±ì¥ì´ ê°€ëŠ¥í•œ ìƒí™©ì…ë‹ˆë‹¤.

ì´ë©”ì¼ ë°œì†¡ í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ ê³ ê¸‰ ì§„ë‹¨ ë³´ê³ ì„œê°€ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.
  `;
}

/**
 * ğŸ§ª Google Apps Script ì´ë©”ì¼ ë°œì†¡ í…ŒìŠ¤íŠ¸
 */
async function testGoogleAppsScriptEmail() {
  console.log('ğŸ“§ Google Apps Script ì´ë©”ì¼ ë°œì†¡ í…ŒìŠ¤íŠ¸ ì‹œì‘...\n');
  
  const testData = createCompleteTestData();
  
  console.log('ğŸ“‹ ì „ì†¡ ë°ì´í„° ìš”ì•½:');
  console.log(`  - íšŒì‚¬ëª…: ${testData.íšŒì‚¬ëª…}`);
  console.log(`  - ì—…ì¢…: ${testData.ì—…ì¢…}`);
  console.log(`  - ë‹´ë‹¹ì: ${testData.ë‹´ë‹¹ìëª…}`);
  console.log(`  - ì´ë©”ì¼: ${testData.ì´ë©”ì¼}`);
  console.log(`  - ì¢…í•©ì ìˆ˜: ${testData.ì¢…í•©ì ìˆ˜}ì `);
  console.log(`  - í•µì‹¬ì§€í‘œ: 6ê°œ (businessModel: ${testData.businessModel}ì  ë“±)`);
  console.log(`  - ê°œë³„ì ìˆ˜: ${Object.keys(testData.ë¬¸í•­ë³„ì ìˆ˜).length}ê°œ ë¬¸í•­`);
  console.log(`  - ë³´ê³ ì„œê¸¸ì´: ${testData.ì§„ë‹¨ë³´ê³ ì„œìš”ì•½.length}ì`);
  console.log(`  - ì´ë©”ì¼ë°œì†¡: ê´€ë¦¬ì + ì‹ ì²­ì ëª¨ë‘ ë°œì†¡\n`);

  try {
    console.log('ğŸš€ Google Apps Script í˜¸ì¶œ ì¤‘...');
    
    const response = await axios.post(
      GOOGLE_SCRIPT_URL,
      testData,
      {
        timeout: 30000,
        headers: {
          'Content-Type': 'application/json'
        }
      }
    );

    if (response.status !== 200) {
      throw new Error(`HTTP ${response.status}: ${response.statusText}`);
    }

    let result;
    try {
      result = typeof response.data === 'string' ? JSON.parse(response.data) : response.data;
    } catch (e) {
      throw new Error(`ì‘ë‹µ íŒŒì‹± ì‹¤íŒ¨: ${response.data}`);
    }

    if (!result.success) {
      throw new Error(`Google Apps Script ì²˜ë¦¬ ì‹¤íŒ¨: ${result.error || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'}`);
    }

    console.log('âœ… Google Apps Script ì²˜ë¦¬ ì„±ê³µ!');
    console.log('ğŸ“Š ì²˜ë¦¬ ê²°ê³¼:');
    console.log(`  - ì²˜ë¦¬ìƒíƒœ: ${result.success ? 'ì„±ê³µ' : 'ì‹¤íŒ¨'}`);
    console.log(`  - ì‹œíŠ¸: ${result.sheet}`);
    console.log(`  - í–‰ë²ˆí˜¸: ${result.row}`);
    console.log(`  - ì—…ì¢…: ${result.ì—…ì¢… || 'ë¯¸í™•ì¸'}`);
    console.log(`  - í•µì‹¬ì§€í‘œ: ${result.í•µì‹¬ì§€í‘œ ? Object.keys(result.í•µì‹¬ì§€í‘œ).length + 'ê°œ' : 'ë¯¸í™•ì¸'}`);
    console.log(`  - ì²˜ë¦¬ë°©ì‹: ${result.ì²˜ë¦¬ë°©ì‹ || 'ê³ ê¸‰_ì—…ì¢…íŠ¹í™”_ë¶„ì„_ì´ë©”ì¼'}`);
    console.log(`  - ì‹œìŠ¤í…œë²„ì „: ${result.ì‹œìŠ¤í…œë²„ì „ || 'ê³ ê¸‰_ì§„ë‹¨_ì‹œìŠ¤í…œ_v3.0'}`);
    
    console.log('\nğŸ“§ ì´ë©”ì¼ ë°œì†¡ í™•ì¸:');
    console.log(`  - ê´€ë¦¬ì ì´ë©”ì¼: hongik423@gmail.com ìœ¼ë¡œ ê³ ê¸‰ ë¶„ì„ ì•Œë¦¼ ë°œì†¡`);
    console.log(`  - ì‹ ì²­ì ì´ë©”ì¼: ${testData.ì´ë©”ì¼} ë¡œ ì œì¡°ì—… íŠ¹í™” í™•ì¸ ë©”ì¼ ë°œì†¡`);
    console.log(`  - ì´ë©”ì¼ ìœ í˜•: ì—…ì¢…ë³„ ë§ì¶¤ ê³ ê¸‰ ì´ë©”ì¼ (AICAMP ë¡œê³  í¬í•¨)`);
    
    return {
      success: true,
      sheet: result.sheet,
      row: result.row,
      message: result.message,
      emailSent: true
    };

  } catch (error) {
    console.error('âŒ Google Apps Script ì´ë©”ì¼ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨:', error.message);
    
    if (error.response) {
      console.error(`ìƒíƒœ ì½”ë“œ: ${error.response.status}`);
      if (error.response.data) {
        console.error(`ì‘ë‹µ ë°ì´í„°:`, error.response.data);
      }
    }
    
    return {
      success: false,
      error: error.message
    };
  }
}

/**
 * ğŸ¯ ë©”ì¸ ì‹¤í–‰
 */
async function runEmailTest() {
  console.log('ğŸš€ AICAMP ê³ ê¸‰ ì§„ë‹¨ ì‹œìŠ¤í…œ ì´ë©”ì¼ ë°œì†¡ í…ŒìŠ¤íŠ¸');
  console.log('=' * 60);
  console.log('ëª©í‘œ: ê´€ë¦¬ì + ì‹ ì²­ì í™•ì¸ ì´ë©”ì¼ ì •ìƒ ë°œì†¡ í™•ì¸');
  console.log('=' * 60);
  
  const result = await testGoogleAppsScriptEmail();
  
  console.log('\n' + '=' * 60);
  if (result.success) {
    console.log('ğŸ‰ ì´ë©”ì¼ ë°œì†¡ í…ŒìŠ¤íŠ¸ ì„±ê³µ!');
    console.log('âœ… ëª¨ë“  ì´ë©”ì¼ì´ ì •ìƒì ìœ¼ë¡œ ë°œì†¡ë˜ì—ˆìŠµë‹ˆë‹¤.');
    console.log('ğŸ“§ ì‹¤ì œ ì´ë©”ì¼í•¨ì„ í™•ì¸í•´ì£¼ì„¸ìš”:');
    console.log('  - ê´€ë¦¬ì: hongik423@gmail.com');
    console.log('  - ì‹ ì²­ì: aicamp.test.email@gmail.com');
  } else {
    console.log('âŒ ì´ë©”ì¼ ë°œì†¡ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨');
    console.log(`ì˜¤ë¥˜: ${result.error}`);
  }
  console.log('=' * 60);
}

if (require.main === module) {
  runEmailTest().catch(error => {
    console.error('ğŸ’¥ í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì¤‘ ì¹˜ëª…ì  ì˜¤ë¥˜:', error);
    process.exit(1);
  });
} 