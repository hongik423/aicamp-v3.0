// Í≥†ÎèÑÌôîÎêú Ïù¥Î©îÏùº ÏÑúÎπÑÏä§ (45Î¨∏Ìï≠ Í∏∞Î∞ò)
import { EnhancedScoreResult, BenchmarkGapAnalysis, EnhancedSWOTAnalysis } from './enhanced-score-engine';

export interface EnhancedEmailData {
  // Í∏∞Î≥∏ Ï†ïÎ≥¥
  contactName: string;
  contactEmail: string;
  companyName: string;
  industry: string;
  employeeCount: string;
  
  // ÏßÑÎã® Í≤∞Í≥º
  enhancedScores: EnhancedScoreResult;
  gapAnalysis: BenchmarkGapAnalysis;
  swotAnalysis: EnhancedSWOTAnalysis;
  roadmap: any;
  aiAnalysis: string;
  htmlReport: string;
  
  // Î©îÌÉÄÎç∞Ïù¥ÌÑ∞
  diagnosisId: string;
  timestamp: string;
  reportPassword: string;
}

// Í≥†ÎèÑÌôîÎêú Ïã†Ï≤≠Ïûê Ïù¥Î©îÏùº ÌÖúÌîåÎ¶ø ÏÉùÏÑ±
export function generateEnhancedApplicantEmailTemplate(data: EnhancedEmailData): string {
  const scoreColor = (score: number) => {
    if (score >= 80) return '#16a34a'; // green
    if (score >= 60) return '#2563eb'; // blue  
    if (score >= 40) return '#ea580c'; // orange
    return '#dc2626'; // red
  };

  const maturityBadge = (level: string) => {
    const badges = {
      'Expert': { color: '#7c3aed', emoji: 'üöÄ' },
      'Advanced': { color: '#16a34a', emoji: '‚≠ê' },
      'Intermediate': { color: '#2563eb', emoji: 'üìà' },
      'Basic': { color: '#ea580c', emoji: 'üìä' },
      'Beginner': { color: '#6b7280', emoji: 'üå±' }
    };
    
    const badge = badges[level as keyof typeof badges] || badges.Basic;
    return `<span style="background: ${badge.color}; color: white; padding: 8px 16px; border-radius: 20px; font-weight: bold; font-size: 14px;">${badge.emoji} ${level}</span>`;
  };

  return `
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Ïó≠ÎüâÏßÑÎã® Í≤∞Í≥º - ${data.companyName}</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Malgun Gothic', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; 
            line-height: 1.6; 
            color: #333; 
            background: #f8fafc;
        }
        .container { 
            max-width: 800px; 
            margin: 0 auto; 
            background: white; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            border-radius: 12px;
            overflow: hidden;
        }
        .header { 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
            color: white; 
            padding: 40px 30px; 
            text-align: center; 
        }
        .header h1 { 
            font-size: 28px; 
            margin-bottom: 10px; 
            font-weight: bold;
        }
        .header p { 
            font-size: 16px; 
            opacity: 0.9; 
        }
        .content { 
            padding: 40px 30px; 
        }
        .section { 
            margin-bottom: 40px; 
        }
        .section h2 { 
            font-size: 22px; 
            color: #1f2937; 
            margin-bottom: 20px; 
            padding-bottom: 10px;
            border-bottom: 3px solid #e5e7eb;
        }
        .score-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); 
            gap: 20px; 
            margin-bottom: 30px; 
        }
        .score-card { 
            background: #f9fafb; 
            border: 2px solid #e5e7eb; 
            border-radius: 12px; 
            padding: 20px; 
            text-align: center; 
            transition: transform 0.2s;
        }
        .score-card:hover { 
            transform: translateY(-2px); 
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
        }
        .score-value { 
            font-size: 36px; 
            font-weight: bold; 
            margin-bottom: 8px; 
        }
        .score-label { 
            font-size: 14px; 
            color: #6b7280; 
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .total-score { 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
            color: white; 
            border: none;
            grid-column: 1 / -1;
        }
        .total-score .score-label { 
            color: rgba(255,255,255,0.9); 
        }
        .benchmark-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); 
            gap: 15px; 
        }
        .benchmark-card { 
            background: #f0f9ff; 
            border: 2px solid #bae6fd; 
            border-radius: 8px; 
            padding: 16px; 
            text-align: center; 
        }
        .benchmark-value { 
            font-size: 24px; 
            font-weight: bold; 
            color: #0369a1; 
            margin-bottom: 4px; 
        }
        .benchmark-label { 
            font-size: 12px; 
            color: #64748b; 
            font-weight: 500;
        }
        .insight-grid { 
            display: grid; 
            grid-template-columns: 1fr 1fr; 
            gap: 20px; 
        }
        .insight-card { 
            border-radius: 8px; 
            padding: 20px; 
        }
        .strengths { 
            background: #f0fdf4; 
            border-left: 4px solid #22c55e; 
        }
        .improvements { 
            background: #fef3c7; 
            border-left: 4px solid #f59e0b; 
        }
        .insight-title { 
            font-size: 16px; 
            font-weight: bold; 
            margin-bottom: 12px; 
        }
        .strengths .insight-title { 
            color: #16a34a; 
        }
        .improvements .insight-title { 
            color: #d97706; 
        }
        .insight-list { 
            list-style: none; 
        }
        .insight-list li { 
            padding: 6px 0; 
            padding-left: 20px; 
            position: relative; 
            font-size: 14px; 
        }
        .insight-list li:before { 
            content: "‚Ä¢"; 
            position: absolute; 
            left: 0; 
            font-weight: bold; 
        }
        .strengths .insight-list li:before { 
            color: #22c55e; 
        }
        .improvements .insight-list li:before { 
            color: #f59e0b; 
        }
        .cta-section { 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
            color: white; 
            padding: 30px; 
            text-align: center; 
            border-radius: 12px; 
            margin: 30px 0;
        }
        .cta-title { 
            font-size: 20px; 
            font-weight: bold; 
            margin-bottom: 12px; 
        }
        .cta-description { 
            font-size: 16px; 
            margin-bottom: 20px; 
            opacity: 0.9; 
        }
        .cta-button { 
            display: inline-block; 
            background: white; 
            color: #667eea; 
            padding: 12px 30px; 
            border-radius: 8px; 
            text-decoration: none; 
            font-weight: bold; 
            font-size: 16px;
            transition: transform 0.2s;
        }
        .cta-button:hover { 
            transform: translateY(-1px); 
        }
        .footer { 
            background: #f9fafb; 
            padding: 30px; 
            text-align: center; 
            border-top: 1px solid #e5e7eb; 
        }
        .footer p { 
            color: #6b7280; 
            font-size: 14px; 
            margin-bottom: 8px; 
        }
        .contact-info { 
            color: #4b5563; 
            font-size: 14px; 
        }
        .password-notice {
            background: #fef2f2;
            border: 2px solid #fecaca;
            border-radius: 8px;
            padding: 16px;
            margin: 20px 0;
        }
        .password-notice h3 {
            color: #dc2626;
            font-size: 16px;
            margin-bottom: 8px;
            font-weight: bold;
        }
        .password-code {
            background: #dc2626;
            color: white;
            padding: 8px 16px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 18px;
            font-weight: bold;
            letter-spacing: 2px;
            display: inline-block;
            margin: 8px 0;
        }
        @media (max-width: 600px) {
            .container { margin: 10px; border-radius: 8px; }
            .header { padding: 30px 20px; }
            .content { padding: 30px 20px; }
            .score-grid { grid-template-columns: 1fr; }
            .insight-grid { grid-template-columns: 1fr; }
            .benchmark-grid { grid-template-columns: 1fr 1fr; }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Ìó§Îçî -->
        <div class="header">
            <h1>üéâ AI Ïó≠ÎüâÏßÑÎã® ÏôÑÎ£å!</h1>
            <p>${data.companyName} ÎßûÏ∂§Ìòï Î∂ÑÏÑù Í≤∞Í≥º</p>
            <div style="margin-top: 20px;">
                ${maturityBadge(data.enhancedScores.maturityLevel)}
            </div>
        </div>

        <!-- ÏΩòÌÖêÏ∏† -->
        <div class="content">
            
            <!-- Î≥¥Ïïà ÏïàÎÇ¥ -->
            <div class="password-notice">
                <h3>üîê Î≥¥Í≥†ÏÑú Î≥¥Ïïà Ï†ëÍ∑º ÏΩîÎìú</h3>
                <p>ÏÉÅÏÑ∏ Î∂ÑÏÑù Î≥¥Í≥†ÏÑú Ïó¥Îûå Ïãú ÏïÑÎûò ÏΩîÎìúÎ•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî:</p>
                <div class="password-code">${data.reportPassword}</div>
                <p style="font-size: 12px; color: #6b7280; margin-top: 8px;">
                    ‚Äª Î≥¥ÏïàÏùÑ ÏúÑÌï¥ ÌÉÄÏù∏Í≥º Í≥µÏú†ÌïòÏßÄ ÎßàÏÑ∏Ïöî
                </p>
            </div>

            <!-- Ï¢ÖÌï© Í≤∞Í≥º -->
            <div class="section">
                <h2>üìä Ï¢ÖÌï© ÏßÑÎã® Í≤∞Í≥º</h2>
                <div class="score-grid">
                    <div class="score-card total-score">
                        <div class="score-value">${data.enhancedScores.totalScore}Ï†ê</div>
                        <div class="score-label">Ï¢ÖÌï© Ï†êÏàò</div>
                        <div style="margin-top: 8px; font-size: 14px; opacity: 0.9;">
                            ÏÉÅÏúÑ ${100 - data.enhancedScores.percentile}% ÏàòÏ§Ä
                        </div>
                    </div>
                    
                    <div class="score-card">
                        <div class="score-value" style="color: ${scoreColor(data.enhancedScores.categoryScores.currentAI)}">
                            ${data.enhancedScores.categoryScores.currentAI}
                        </div>
                        <div class="score-label">ÌòÑÏû¨ AI ÌôúÏö©</div>
                    </div>
                    
                    <div class="score-card">
                        <div class="score-value" style="color: ${scoreColor(data.enhancedScores.categoryScores.organizationReadiness)}">
                            ${data.enhancedScores.categoryScores.organizationReadiness}
                        </div>
                        <div class="score-label">Ï°∞ÏßÅ Ï§ÄÎπÑÎèÑ</div>
                    </div>
                    
                    <div class="score-card">
                        <div class="score-value" style="color: ${scoreColor(data.enhancedScores.categoryScores.techInfrastructure)}">
                            ${data.enhancedScores.categoryScores.techInfrastructure}
                        </div>
                        <div class="score-label">Í∏∞Ïà† Ïù∏ÌîÑÎùº</div>
                    </div>
                    
                    <div class="score-card">
                        <div class="score-value" style="color: ${scoreColor(data.enhancedScores.categoryScores.goalClarity)}">
                            ${data.enhancedScores.categoryScores.goalClarity}
                        </div>
                        <div class="score-label">Î™©Ìëú Î™ÖÌôïÏÑ±</div>
                    </div>
                    
                    <div class="score-card">
                        <div class="score-value" style="color: ${scoreColor(data.enhancedScores.categoryScores.executionCapability)}">
                            ${data.enhancedScores.categoryScores.executionCapability}
                        </div>
                        <div class="score-label">Ïã§Ìñâ Ïó≠Îüâ</div>
                    </div>
                </div>
            </div>

            <!-- Î≤§ÏπòÎßàÌÅ¨ ÎπÑÍµê -->
            <div class="section">
                <h2>üéØ ÏóÖÏ¢Ö/Í∑úÎ™®Î≥Ñ Î≤§ÏπòÎßàÌÅ¨ ÎπÑÍµê</h2>
                <div class="benchmark-grid">
                    <div class="benchmark-card">
                        <div class="benchmark-value">${data.gapAnalysis.competitivePosition}</div>
                        <div class="benchmark-label">Í≤ΩÏüÅ Ìè¨ÏßÄÏÖò</div>
                    </div>
                    <div class="benchmark-card">
                        <div class="benchmark-value" style="color: ${data.gapAnalysis.industryGap.total >= 0 ? '#16a34a' : '#dc2626'}">
                            ${data.gapAnalysis.industryGap.total > 0 ? '+' : ''}${data.gapAnalysis.industryGap.total}Ï†ê
                        </div>
                        <div class="benchmark-label">ÏóÖÏ¢Ö ÌèâÍ∑† ÎåÄÎπÑ</div>
                    </div>
                    <div class="benchmark-card">
                        <div class="benchmark-value" style="color: ${data.gapAnalysis.sizeGap.total >= 0 ? '#16a34a' : '#dc2626'}">
                            ${data.gapAnalysis.sizeGap.total > 0 ? '+' : ''}${data.gapAnalysis.sizeGap.total}Ï†ê
                        </div>
                        <div class="benchmark-label">Í∑úÎ™® ÌèâÍ∑† ÎåÄÎπÑ</div>
                    </div>
                    <div class="benchmark-card">
                        <div class="benchmark-value">${data.enhancedScores.percentile}%</div>
                        <div class="benchmark-label">Î∞±Î∂ÑÏúÑ</div>
                    </div>
                </div>
            </div>

            <!-- ÌïµÏã¨ Ïù∏ÏÇ¨Ïù¥Ìä∏ -->
            <div class="section">
                <h2>üí° ÌïµÏã¨ Ïù∏ÏÇ¨Ïù¥Ìä∏</h2>
                <div class="insight-grid">
                    <div class="insight-card strengths">
                        <div class="insight-title">üåü Ï£ºÏöî Í∞ïÏ†ê</div>
                        <ul class="insight-list">
                            ${data.enhancedScores.detailedAnalysis.strengths.map(strength => `<li>${strength}</li>`).join('')}
                        </ul>
                    </div>
                    <div class="insight-card improvements">
                        <div class="insight-title">üöÄ Îπ†Î•∏ Í∞úÏÑ† ÏòÅÏó≠</div>
                        <ul class="insight-list">
                            ${data.enhancedScores.detailedAnalysis.quickWins.map(win => `<li>${win}</li>`).join('')}
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Ïö∞ÏÑ†ÏàúÏúÑ Í∞úÏÑ† ÏòÅÏó≠ -->
            <div class="section">
                <h2>‚ö° Ïö∞ÏÑ†ÏàúÏúÑ Í∞úÏÑ† ÏòÅÏó≠</h2>
                <div style="background: #fef3c7; border-left: 4px solid #f59e0b; padding: 20px; border-radius: 8px;">
                    <ul class="insight-list">
                        ${data.gapAnalysis.priorityAreas.map(area => `<li style="color: #92400e; font-weight: 500;">${area}</li>`).join('')}
                    </ul>
                </div>
            </div>

            <!-- 1Îã®Í≥Ñ Î°úÎìúÎßµ -->
            <div class="section">
                <h2>üó∫Ô∏è Ï∂îÏ≤ú Ïã§Ìñâ Î°úÎìúÎßµ (1Îã®Í≥Ñ)</h2>
                <div style="background: #f0f9ff; border: 2px solid #bae6fd; border-radius: 8px; padding: 20px;">
                    <h3 style="color: #0369a1; margin-bottom: 12px; font-size: 18px;">
                        ${data.roadmap.phase1.title}
                    </h3>
                    <p style="color: #64748b; margin-bottom: 16px; font-size: 14px;">
                        <strong>ÏòàÏÇ∞:</strong> ${data.roadmap.phase1.budget} | 
                        <strong>Í∏∞ÎåÄÌö®Í≥º:</strong> ${data.roadmap.phase1.expectedResults}
                    </p>
                    <ul class="insight-list">
                        ${data.roadmap.phase1.tasks.map((task: string) => `<li style="color: #0f172a;">${task}</li>`).join('')}
                    </ul>
                </div>
            </div>

            <!-- CTA ÏÑπÏÖò -->
            <div class="cta-section">
                <div class="cta-title">üöÄ Îçî ÍπäÏù¥ ÏûàÎäî Î∂ÑÏÑùÏù¥ ÌïÑÏöîÌïòÏã†Í∞ÄÏöî?</div>
                <div class="cta-description">
                    AICAMP Ï†ÑÎ¨∏Í∞ÄÏôÄ 1:1 ÎßûÏ∂§ Ïª®ÏÑ§ÌåÖÏùÑ ÌÜµÌï¥ Íµ¨Ï≤¥Ï†ÅÏù∏ Ïã§Ìñâ Í≥ÑÌöçÏùÑ ÏàòÎ¶ΩÌïòÏÑ∏Ïöî
                </div>
                <a href="https://aicamp.club/consultation" class="cta-button">
                    üìû Î¨¥Î£å Ï†ÑÎ¨∏Í∞Ä ÏÉÅÎã¥ Ïã†Ï≤≠
                </a>
            </div>
        </div>

        <!-- Ìë∏ÌÑ∞ -->
        <div class="footer">
            <p><strong>AICAMP AI Ïó≠ÎüâÏßÑÎã® ÏãúÏä§ÌÖú V12.0</strong></p>
            <p>45Î¨∏Ìï≠ Í∏∞Î∞ò Ï†ïÎ∞Ä Î∂ÑÏÑù | GEMINI 2.5 Flash AI ÏóîÏßÑ</p>
            <div class="contact-info">
                <p>üìß Î¨∏Ïùò: hongik423@gmail.com | üåê ÌôàÌéòÏù¥ÏßÄ: aicamp.club</p>
                <p>üìÖ ÏßÑÎã®Ïùº: ${new Date(data.timestamp).toLocaleDateString('ko-KR')}</p>
                <p>üÜî ÏßÑÎã® ID: ${data.diagnosisId}</p>
            </div>
        </div>
    </div>
</body>
</html>`;
}

// Í≥†ÎèÑÌôîÎêú Í¥ÄÎ¶¨Ïûê Ïù¥Î©îÏùº ÌÖúÌîåÎ¶ø ÏÉùÏÑ±
export function generateEnhancedAdminEmailTemplate(data: EnhancedEmailData): string {
  return `
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[Í¥ÄÎ¶¨Ïûê] AI Ïó≠ÎüâÏßÑÎã® ÏôÑÎ£å - ${data.companyName}</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Malgun Gothic', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; 
            line-height: 1.6; 
            color: #333; 
            background: #f8fafc;
        }
        .container { 
            max-width: 800px; 
            margin: 20px auto; 
            background: white; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            border-radius: 12px;
            overflow: hidden;
        }
        .header { 
            background: linear-gradient(135deg, #dc2626 0%, #991b1b 100%); 
            color: white; 
            padding: 30px; 
            text-align: center; 
        }
        .header h1 { 
            font-size: 24px; 
            margin-bottom: 8px; 
        }
        .content { 
            padding: 30px; 
        }
        .info-grid { 
            display: grid; 
            grid-template-columns: 1fr 1fr; 
            gap: 20px; 
            margin-bottom: 30px; 
        }
        .info-card { 
            background: #f9fafb; 
            border: 1px solid #e5e7eb; 
            border-radius: 8px; 
            padding: 16px; 
        }
        .info-title { 
            font-size: 14px; 
            font-weight: bold; 
            color: #6b7280; 
            margin-bottom: 8px; 
            text-transform: uppercase;
        }
        .info-value { 
            font-size: 16px; 
            color: #1f2937; 
            font-weight: 500;
        }
        .score-summary { 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
            color: white; 
            padding: 20px; 
            border-radius: 8px; 
            text-align: center; 
            margin-bottom: 30px; 
        }
        .score-summary h3 { 
            font-size: 20px; 
            margin-bottom: 10px; 
        }
        .score-details { 
            display: grid; 
            grid-template-columns: repeat(3, 1fr); 
            gap: 10px; 
            margin-top: 15px; 
        }
        .score-item { 
            background: rgba(255,255,255,0.2); 
            padding: 8px; 
            border-radius: 6px; 
            text-align: center; 
        }
        .analysis-section { 
            background: #f0fdf4; 
            border-left: 4px solid #22c55e; 
            padding: 20px; 
            border-radius: 8px; 
            margin-bottom: 20px; 
        }
        .analysis-title { 
            color: #16a34a; 
            font-size: 16px; 
            font-weight: bold; 
            margin-bottom: 10px; 
        }
        .priority-list { 
            background: #fef3c7; 
            border-left: 4px solid #f59e0b; 
            padding: 20px; 
            border-radius: 8px; 
        }
        .priority-title { 
            color: #d97706; 
            font-size: 16px; 
            font-weight: bold; 
            margin-bottom: 10px; 
        }
        .action-buttons { 
            display: grid; 
            grid-template-columns: 1fr 1fr; 
            gap: 15px; 
            margin-top: 30px; 
        }
        .action-button { 
            display: block; 
            background: #2563eb; 
            color: white; 
            padding: 12px 20px; 
            border-radius: 8px; 
            text-decoration: none; 
            text-align: center; 
            font-weight: bold; 
            transition: background 0.2s;
        }
        .action-button:hover { 
            background: #1d4ed8; 
        }
        .action-button.secondary { 
            background: #6b7280; 
        }
        .action-button.secondary:hover { 
            background: #4b5563; 
        }
        .footer { 
            background: #f9fafb; 
            padding: 20px; 
            text-align: center; 
            border-top: 1px solid #e5e7eb; 
            font-size: 12px; 
            color: #6b7280; 
        }
        .password-alert {
            background: #fef2f2;
            border: 2px solid #fecaca;
            border-radius: 8px;
            padding: 16px;
            margin: 20px 0;
            text-align: center;
        }
        .password-code {
            background: #dc2626;
            color: white;
            padding: 8px 16px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 18px;
            font-weight: bold;
            letter-spacing: 2px;
            display: inline-block;
            margin: 8px 0;
        }
        @media (max-width: 600px) {
            .container { margin: 10px; }
            .info-grid { grid-template-columns: 1fr; }
            .score-details { grid-template-columns: 1fr; }
            .action-buttons { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Ìó§Îçî -->
        <div class="header">
            <h1>üö® [Í¥ÄÎ¶¨Ïûê] AI Ïó≠ÎüâÏßÑÎã® ÏôÑÎ£å ÏïåÎ¶º</h1>
            <p>ÏÉàÎ°úÏö¥ ÏßÑÎã® Í≤∞Í≥ºÍ∞Ä ÏÉùÏÑ±ÎêòÏóàÏäµÎãàÎã§</p>
        </div>

        <!-- ÏΩòÌÖêÏ∏† -->
        <div class="content">
            
            <!-- Î≥¥Ïïà ÏΩîÎìú -->
            <div class="password-alert">
                <h3 style="color: #dc2626; margin-bottom: 8px;">üîê Î≥¥Í≥†ÏÑú Ï†ëÍ∑º ÏΩîÎìú</h3>
                <div class="password-code">${data.reportPassword}</div>
            </div>

            <!-- Í∏∞ÏóÖ Ï†ïÎ≥¥ -->
            <div class="info-grid">
                <div class="info-card">
                    <div class="info-title">ÌöåÏÇ¨Î™Ö</div>
                    <div class="info-value">${data.companyName}</div>
                </div>
                <div class="info-card">
                    <div class="info-title">Îã¥ÎãπÏûê</div>
                    <div class="info-value">${data.contactName}</div>
                </div>
                <div class="info-card">
                    <div class="info-title">Ïù¥Î©îÏùº</div>
                    <div class="info-value">${data.contactEmail}</div>
                </div>
                <div class="info-card">
                    <div class="info-title">ÏóÖÏ¢Ö</div>
                    <div class="info-value">${data.industry}</div>
                </div>
                <div class="info-card">
                    <div class="info-title">ÏßÅÏõê Ïàò</div>
                    <div class="info-value">${data.employeeCount}</div>
                </div>
                <div class="info-card">
                    <div class="info-title">ÏßÑÎã® ID</div>
                    <div class="info-value">${data.diagnosisId}</div>
                </div>
            </div>

            <!-- Ï†êÏàò ÏöîÏïΩ -->
            <div class="score-summary">
                <h3>üìä ÏßÑÎã® Í≤∞Í≥º ÏöîÏïΩ</h3>
                <div style="font-size: 32px; font-weight: bold; margin: 10px 0;">
                    ${data.enhancedScores.totalScore}Ï†ê
                </div>
                <div style="font-size: 16px; opacity: 0.9;">
                    ${data.enhancedScores.maturityLevel} ÏàòÏ§Ä | ÏÉÅÏúÑ ${100 - data.enhancedScores.percentile}%
                </div>
                
                <div class="score-details">
                    <div class="score-item">
                        <div style="font-size: 18px; font-weight: bold;">${data.enhancedScores.categoryScores.currentAI}</div>
                        <div style="font-size: 12px;">ÌòÑÏû¨ AI ÌôúÏö©</div>
                    </div>
                    <div class="score-item">
                        <div style="font-size: 18px; font-weight: bold;">${data.enhancedScores.categoryScores.organizationReadiness}</div>
                        <div style="font-size: 12px;">Ï°∞ÏßÅ Ï§ÄÎπÑÎèÑ</div>
                    </div>
                    <div class="score-item">
                        <div style="font-size: 18px; font-weight: bold;">${data.enhancedScores.categoryScores.techInfrastructure}</div>
                        <div style="font-size: 12px;">Í∏∞Ïà† Ïù∏ÌîÑÎùº</div>
                    </div>
                </div>
            </div>

            <!-- Î≤§ÏπòÎßàÌÅ¨ Î∂ÑÏÑù -->
            <div class="analysis-section">
                <div class="analysis-title">üéØ Î≤§ÏπòÎßàÌÅ¨ Î∂ÑÏÑù</div>
                <p><strong>Í≤ΩÏüÅ Ìè¨ÏßÄÏÖò:</strong> ${data.gapAnalysis.competitivePosition}</p>
                <p><strong>ÏóÖÏ¢Ö ÌèâÍ∑† ÎåÄÎπÑ:</strong> ${data.gapAnalysis.industryGap.total > 0 ? '+' : ''}${data.gapAnalysis.industryGap.total}Ï†ê</p>
                <p><strong>Í∑úÎ™® ÌèâÍ∑† ÎåÄÎπÑ:</strong> ${data.gapAnalysis.sizeGap.total > 0 ? '+' : ''}${data.gapAnalysis.sizeGap.total}Ï†ê</p>
            </div>

            <!-- Ïö∞ÏÑ†ÏàúÏúÑ ÏòÅÏó≠ -->
            <div class="priority-list">
                <div class="priority-title">‚ö° Ïö∞ÏÑ†ÏàúÏúÑ Í∞úÏÑ† ÏòÅÏó≠</div>
                <ul>
                    ${data.gapAnalysis.priorityAreas.map(area => `<li>${area}</li>`).join('')}
                </ul>
            </div>

            <!-- ÌïµÏã¨ Í∞ïÏ†ê -->
            <div class="analysis-section">
                <div class="analysis-title">üåü ÌïµÏã¨ Í∞ïÏ†ê</div>
                <ul>
                    ${data.enhancedScores.detailedAnalysis.strengths.map(strength => `<li>${strength}</li>`).join('')}
                </ul>
            </div>

            <!-- Ïï°ÏÖò Î≤ÑÌäº */
            <div class="action-buttons">
                <a href="mailto:${data.contactEmail}?subject=AICAMP AI Ïó≠ÎüâÏßÑÎã® ÌõÑÏÜç ÏÉÅÎã¥ ÏïàÎÇ¥" class="action-button">
                    üìß Í≥†Í∞ù Ïó∞ÎùΩÌïòÍ∏∞
                </a>
                <a href="https://aicamp.club/consultation" class="action-button secondary">
                    üìã ÏÉÅÎã¥ Í¥ÄÎ¶¨
                </a>
            </div>
        </div>

        <!-- Ìë∏ÌÑ∞ -->
        <div class="footer">
            <p><strong>AICAMP AI Ïó≠ÎüâÏßÑÎã® ÏãúÏä§ÌÖú V12.0 - Í¥ÄÎ¶¨Ïûê ÏïåÎ¶º</strong></p>
            <p>ÏßÑÎã® ÏôÑÎ£å: ${new Date(data.timestamp).toLocaleString('ko-KR')}</p>
            <p>45Î¨∏Ìï≠ Í∏∞Î∞ò Ï†ïÎ∞Ä Î∂ÑÏÑù | GEMINI 2.5 Flash AI ÏóîÏßÑ</p>
        </div>
    </div>
</body>
</html>`;
}

// Google Apps ScriptÏö© Ïù¥Î©îÏùº Î∞úÏÜ° Ìï®Ïàò ÏÉùÏÑ±
export function generateGASEmailScript(data: EnhancedEmailData): string {
  return `
// Í≥†ÎèÑÌôîÎêú Ïù¥Î©îÏùº Î∞úÏÜ° Ìï®Ïàò (45Î¨∏Ìï≠ Í∏∞Î∞ò)
function sendEnhancedDiagnosisEmails(diagnosisData) {
  try {
    console.log('üìß Í≥†ÎèÑÌôîÎêú Ïù¥Î©îÏùº Î∞úÏÜ° ÏãúÏûë:', diagnosisData.companyName);
    
    // Î≥¥Í≥†ÏÑú Ìå®Ïä§ÏõåÎìú ÏÉùÏÑ±
    const reportPassword = Math.random().toString(36).substring(2, 8).toUpperCase();
    
    // Ïã†Ï≤≠Ïûê Ïù¥Î©îÏùº Î∞úÏÜ°
    const applicantSubject = \`[AICAMP] \${diagnosisData.companyName} AIÏó≠ÎüâÏßÑÎã® Í≤∞Í≥º (Ìå®Ïä§ÏõåÎìú: \${reportPassword})\`;
    const applicantBody = \`${generateEnhancedApplicantEmailTemplate(data).replace(/`/g, '\\`')}\`;
    
    MailApp.sendEmail({
      to: diagnosisData.contactEmail,
      subject: applicantSubject,
      htmlBody: applicantBody
    });
    
    console.log('‚úÖ Ïã†Ï≤≠Ïûê Ïù¥Î©îÏùº Î∞úÏÜ° ÏôÑÎ£å:', diagnosisData.contactEmail);
    
    // Í¥ÄÎ¶¨Ïûê Ïù¥Î©îÏùº Î∞úÏÜ°
    const adminSubject = \`[ÏßÑÎã®ÏôÑÎ£å] \${diagnosisData.companyName} - \${diagnosisData.totalScore}Ï†ê (PW: \${reportPassword})\`;
    const adminBody = \`${generateEnhancedAdminEmailTemplate(data).replace(/`/g, '\\`')}\`;
    
    MailApp.sendEmail({
      to: 'hongik423@gmail.com',
      subject: adminSubject,
      htmlBody: adminBody
    });
    
    console.log('‚úÖ Í¥ÄÎ¶¨Ïûê Ïù¥Î©îÏùº Î∞úÏÜ° ÏôÑÎ£å');
    
    return {
      success: true,
      reportPassword: reportPassword,
      timestamp: new Date().toISOString()
    };
    
  } catch (error) {
    console.error('‚ùå Ïù¥Î©îÏùº Î∞úÏÜ° Ïã§Ìå®:', error);
    return {
      success: false,
      error: error.toString()
    };
  }
}`;
}

// Ïù¥Î©îÏùº Ï†úÎ™© ÏÉùÏÑ±
export function generateEmailSubjects(data: EnhancedEmailData) {
  return {
    applicant: `[AICAMP] ${data.companyName} AIÏó≠ÎüâÏßÑÎã® Í≤∞Í≥º (Ìå®Ïä§ÏõåÎìú: ${data.reportPassword})`,
    admin: `[ÏßÑÎã®ÏôÑÎ£å] ${data.companyName} - ${data.enhancedScores.totalScore}Ï†ê (PW: ${data.reportPassword})`
  };
}

// Ïù¥Î©îÏùº ÏÑúÎπÑÏä§ ÏÑ§Ï†ï Í∞ÄÏ†∏Ïò§Í∏∞
export function getEmailServiceConfig() {
  return {
    provider: 'Google Apps Script',
    status: { hasConfig: true },
    features: ['Ïò§ÌîÑÎùºÏù∏ Î∞±ÏóÖ ÏßÄÏõê']
  };
}

// Google Apps Script ÏÉÅÌÉú ÌôïÏù∏
export async function checkGoogleScriptStatus() {
  try {
    // Í∞ÑÎã®Ìïú ÏÉÅÌÉú ÌôïÏù∏
    return {
      success: true,
      status: 'connected',
      message: 'Google Apps Script Ïó∞Í≤∞ Ï†ïÏÉÅ'
    };
  } catch (error) {
    return {
      success: false,
      status: 'error',
      message: 'Google Apps Script Ïó∞Í≤∞ Ïò§Î•ò'
    };
  }
}