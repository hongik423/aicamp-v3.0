# 🎯 AI 무료진단 간단접수시스템 배포 가이드

## 📋 **개선사항 요약**

### ✅ **완료된 수정사항**
1. **PDF 이메일 발송 기능 완전 제거** - 오류 원인이었던 복잡한 PDF 첨부 로직 삭제
2. **간단한 접수 확인 이메일 시스템** - 신청자에게 접수 확인 메일만 발송
3. **관리자 접수 보고 이메일** - 관리자에게 새 접수 알림 메일 발송
4. **AI Camp 로고 적용** - 이메일 템플릿에 AICAMP 브랜딩 적용
5. **구글시트 연계 간소화** - 복잡한 58개 컬럼에서 12개 핵심 컬럼으로 축소

### ❌ **제거된 기능들**
- PDF 첨부 이메일 기능
- 복잡한 시각적 보고서 생성
- HTML 템플릿 첨부 기능
- 다중 시트 관리 (1개 시트로 간소화)

---

## 🚀 **1단계: 새로운 구글 앱스 스크립트 배포**

### 1.1 구글 앱스 스크립트 에디터 접속
```
https://script.google.com/d/1mi6DVh9EsVBO7IK5dUUmQpbkqPhuBIcYtLsaE9STfp9_KeZfD9nAw8zj/edit
```

### 1.2 기존 코드 완전 교체
1. **기존 Code.gs 파일의 모든 내용 삭제**
2. **docs/google_apps_script_simple_diagnosis_reception.js** 파일의 전체 코드 복사
3. **Code.gs에 새 코드 붙여넣기**

### 1.3 환경변수 확인
```javascript
const SPREADSHEET_ID = '1QNgQSsyAdeSu1ejhIm4PFyeSRKy3NmwbLQnKLF8vqA0';
const ADMIN_EMAIL = 'hongik423@gmail.com';
const SHEET_NAME = 'AI_무료진단접수';
```

### 1.4 새 배포 생성
1. **저장**: `Ctrl + S`
2. **배포** → **새 배포** 생성
3. **유형**: 웹 앱
4. **액세스 권한**: "모든 사용자"
5. **새 웹앱 URL 복사**

---

## 📊 **2단계: 구글시트 준비**

### 2.1 새 시트 생성
- 기존 구글시트에 **"AI_무료진단접수"** 시트 추가
- 또는 스크립트 실행 시 자동 생성됨

### 2.2 시트 구조 (12개 컬럼)
```
접수일시 | 회사명 | 담당자명 | 이메일 | 연락처 | 업종 | 진단점수 | 진단등급 | 처리상태 | 타임스탬프 | 접수경로 | 추가정보
```

---

## ⚙️ **3단계: 환경변수 업데이트**

### 3.1 프로젝트 루트의 .env.local 파일 수정
```bash
# 새로운 구글 앱스 스크립트 URL로 교체 (배포 후 받은 URL)
NEXT_PUBLIC_GOOGLE_SCRIPT_URL=https://script.google.com/macros/s/[새로운배포ID]/exec

# 기존 구글시트 ID 유지
NEXT_PUBLIC_GOOGLE_SHEETS_ID=1QNgQSsyAdeSu1ejhIm4PFyeSRKy3NmwbLQnKLF8vqA0

# 기타 설정 유지
NEXT_PUBLIC_BASE_URL=https://aicamp-v3-0.vercel.app
```

### 3.2 Vercel 환경변수 업데이트
1. **Vercel 대시보드** → **프로젝트 설정** → **Environment Variables**
2. **NEXT_PUBLIC_GOOGLE_SCRIPT_URL** 값을 새 URL로 업데이트
3. **Redeploy** 실행

---

## 🧪 **4단계: 테스트 실행**

### 4.1 구글 앱스 스크립트 테스트
```javascript
// 구글 앱스 스크립트 에디터에서 실행
function runTest() {
  testDiagnosisSubmission();
}
```

### 4.2 웹사이트 테스트
1. **AI 무료진단 페이지** 접속: `/diagnosis`
2. **진단 완료 후** "AI 무료진단 접수 신청" 버튼 클릭
3. **이메일 확인**: 접수 확인 메일 수신 여부
4. **관리자 이메일 확인**: hongik423@gmail.com으로 알림 메일 수신
5. **구글시트 확인**: 새 데이터 저장 여부

---

## 📧 **5단계: 이메일 템플릿 확인**

### 5.1 신청자 접수 확인 메일
- **제목**: `🎉 [AICAMP] [회사명] AI 무료진단 접수 완료 안내`
- **내용**: AICAMP 로고, 접수 정보, 다음 진행사항, 전문가 연락처
- **디자인**: 그라데이션 헤더, 카드 형태 레이아웃

### 5.2 관리자 알림 메일
- **제목**: `🔔 [AICAMP] 새로운 AI 무료진단 접수 - [회사명]`
- **내용**: 접수 세부정보, 필요한 액션, 구글시트 바로가기 링크
- **디자인**: 관리자용 간결한 정보 표시

---

## 🔧 **6단계: 문제 해결**

### 6.1 자주 발생하는 오류
```
❌ "Google Apps Script URL이 설정되지 않았습니다"
✅ 해결: .env.local 파일의 NEXT_PUBLIC_GOOGLE_SCRIPT_URL 확인

❌ "구글시트 저장 오류"  
✅ 해결: 구글시트 권한 확인, SPREADSHEET_ID 확인

❌ "이메일 발송 실패"
✅ 해결: Gmail API 권한 승인, 관리자 이메일 주소 확인
```

### 6.2 로그 확인 방법
- **구글 앱스 스크립트**: 실행 트랜스크립트 확인
- **웹사이트**: 브라우저 개발자 도구 Console 확인
- **Vercel**: 배포 로그 및 Function 로그 확인

---

## 📈 **7단계: 성능 모니터링**

### 7.1 주요 지표
- **접수 성공률**: 구글시트 저장 성공 비율
- **이메일 발송률**: 신청자/관리자 이메일 발송 성공률
- **응답 시간**: API 응답 속도 (목표: 3초 이내)

### 7.2 모니터링 도구
- **구글시트**: 일일 접수 현황 확인
- **Gmail**: 이메일 발송 기록 확인
- **Vercel Analytics**: 트래픽 및 성능 지표

---

## 🎉 **배포 완료 체크리스트**

- [ ] 새로운 구글 앱스 스크립트 배포 완료
- [ ] 환경변수 업데이트 완료 (.env.local + Vercel)
- [ ] 구글시트 "AI_무료진단접수" 시트 생성 확인
- [ ] 테스트 접수 신청 성공 확인
- [ ] 신청자 접수 확인 이메일 수신 확인
- [ ] 관리자 알림 이메일 수신 확인
- [ ] 구글시트 데이터 저장 확인
- [ ] PDF 첨부 기능 완전 제거 확인

---

## 📞 **지원 및 문의**

### 기술적 문제 발생 시
- **담당자**: 이후경 경영지도사
- **연락처**: 010-9251-9743
- **이메일**: hongik423@gmail.com

### 추가 개선사항
- 로고 이미지 실제 파일로 교체
- 이메일 템플릿 디자인 세부 조정
- 구글시트 자동 백업 시스템 구축

---

**🎯 이제 AI 무료진단 시스템이 PDF 첨부 오류 없이 안정적으로 작동합니다!** 